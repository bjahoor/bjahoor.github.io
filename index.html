<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Brandon Jahoor â€” Portfolio</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300..900&family=Space+Grotesk:wght@300..700&display=swap" rel="stylesheet">
<style>
/* --- keep your existing styles (shortened here for brevity) --- */
body{margin:0;font-family:Inter,system-ui;color:#eef0f4;background:#0b0c12}
.hero{text-align:center;padding:3rem 1rem}
h1{font-family:"Space Grotesk",sans-serif;font-size:3rem;margin:0}
#robot-arm{text-align:center;padding:3rem 1rem}
#robotCanvas{width:100%;height:500px;border:1px solid #262837;border-radius:14px}
.sliders{display:flex;flex-wrap:wrap;justify-content:center;gap:1rem;margin-top:1rem}
.sliders label{display:flex;flex-direction:column;align-items:center;font-size:.9rem;color:#9aa1ac}
.sliders input{width:150px}
</style>
</head>
<body>

<section class="hero">
  <h1>Mechatronics & Robotics Engineering<br>University of Waterloo</h1>
  <p>Interactive Emika Panda Arm Demo</p>
</section>

<section id="robot-arm">
  <canvas id="robotCanvas"></canvas>
  <div class="sliders" id="jointSliders"></div>
</section>

<script type="module">
import * as THREE from "https://unpkg.com/three@0.165.0/build/three.module.js";
import { GLTFLoader } from "https://unpkg.com/three@0.165.0/examples/jsm/loaders/GLTFLoader.js";
import { OrbitControls } from "https://unpkg.com/three@0.165.0/examples/jsm/controls/OrbitControls.js";

const canvas=document.getElementById('robotCanvas');
const renderer=new THREE.WebGLRenderer({canvas,antialias:true,alpha:true});
renderer.setSize(canvas.clientWidth,canvas.clientHeight);
renderer.setPixelRatio(window.devicePixelRatio);

const scene=new THREE.Scene();
const camera=new THREE.PerspectiveCamera(45,canvas.clientWidth/canvas.clientHeight,0.1,100);
camera.position.set(2,2,5);
const controls=new OrbitControls(camera,renderer.domElement);
controls.enableDamping=true;

scene.add(new THREE.HemisphereLight(0xffffff,0x444444,1));
const light=new THREE.DirectionalLight(0xffffff,1);
light.position.set(5,5,5);
scene.add(light);

let joints=[];
const loader=new GLTFLoader();
loader.load("images/emika_panda.glb",gltf=>{
  const model=gltf.scene;
  model.scale.set(0.01,0.01,0.01); // typical for CAD -> very large
  scene.add(model);

  // Center & frame camera
  const box=new THREE.Box3().setFromObject(model);
  const center=box.getCenter(new THREE.Vector3());
  const size=box.getSize(new THREE.Vector3());
  controls.target.copy(center);
  camera.position.set(center.x+size.length()*0.3,center.y+size.length()*0.2,center.z+size.length()*0.6);
  camera.lookAt(center);

  // Try to grab first few children as joints (log structure)
  console.log("Model hierarchy:", model);
  joints=model.children.slice(0,7);

  const sliders=document.getElementById('jointSliders');
  joints.forEach((joint,i)=>{
    const lbl=document.createElement('label');
    lbl.textContent=`Joint ${i+1}`;
    const slider=document.createElement('input');
    slider.type='range';slider.min=-180;slider.max=180;slider.value=0;
    slider.addEventListener('input',()=>{joint.rotation.z=THREE.MathUtils.degToRad(slider.value);});
    lbl.appendChild(slider);
    sliders.appendChild(lbl);
  });
});

window.addEventListener('resize',()=>{
  renderer.setSize(canvas.clientWidth,canvas.clientHeight);
  camera.aspect=canvas.clientWidth/canvas.clientHeight;
  camera.updateProjectionMatrix();
});

(function animate(){
  requestAnimationFrame(animate);
  controls.update();
  renderer.render(scene,camera);
})();
</script>
</body>
</html>
